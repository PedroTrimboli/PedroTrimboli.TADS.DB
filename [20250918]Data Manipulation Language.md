-- Tabela de Clientes

```sql
CREATE TABLE CLIENTES (
  ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  NOME VARCHAR2(100) NOT NULL,
  TELEFONE VARCHAR2(20),
  EMAIL VARCHAR2(120) UNIQUE
);
```

-- Tabela de Carros

```sql
CREATE TABLE CARROS (
  ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  MARCA VARCHAR2(50) NOT NULL,
  MODELO VARCHAR2(50) NOT NULL,
  ANO NUMBER(4) NOT NULL,
  PRECO NUMBER(10,2) NOT NULL
);
```

-- Tabela de Vendas

```sql
CREATE TABLE VENDAS (
  ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  CLIENTE_ID NUMBER NOT NULL,
  CARRO_ID NUMBER NOT NULL,
  DATA_VENDA DATE DEFAULT SYSDATE,
  VALOR NUMBER(10,2) NOT NULL,

  CONSTRAINT FK_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTES(id),
  CONSTRAINT FK_CARRO   FOREIGN KEY (CARRO_ID)   REFERENCES CARROS(id)
);
```
-----------------------------------------------------------------------------------------------------------------------------

-- INSERINDO DADOS


-- Inserindo dados em clientes

```sql
INSERT INTO CLIENTES (nome, telefone, email)
VALUES ('Pedro', '11999999999', 'pedro@carros.com');

INSERT INTO CLIENTES (nome, telefone, email)
VALUES ('Henrique', '11999999999', 'henrique@carros.com');


INSERT INTO CLIENTES (nome, telefone, email)
VALUES ('Leandro', '11999999999', 'Leandro@carros.com');
```

-- Inserindo dados em Carros

```sql
INSERT INTO CARROS (MARCA, MODELO, ANO, PRECO)
VALUES ('Toyota', 'Supra', 2025, 300000);

INSERT INTO CARROS (MARCA, MODELO, ANO, PRECO)
VALUES ('Honda', 'Civic G10', 2025, 250000);

INSERT INTO CARROS (MARCA, MODELO, ANO, PRECO)
VALUES ('Nissan', 'GTR', 2025, 650000); 
```

-- Inserindo dados em Vendas

```sql
INSERT INTO VENDAS (cliente_id, carro_id, valor)
VALUES (21, 2, 300000);

INSERT INTO VENDAS (cliente_id, carro_id, valor)
VALUES (1, 21, 250000);

INSERT INTO VENDAS (cliente_id, carro_id, valor)
VALUES (2, 1, 650000);
```

-----------------------------------------------------------------------------------------------------------------------------

-- UPDATE NOS VALORES DOS CARROS: + 10% EM TODOS OS PREÃ‡OS

```sql
UPDATE CARROS SET PRECO = PRECO * 1.1;
```
-----------------------------------------------------------------------------------------------------------------------------

-- DELETANDO VENDAS

```sql
DELETE FROM VENDAS
WHERE id = 3;
```
-----------------------------------------------------------------------------------------------------------------------------

-- MERGE (PROFESSOR MEUS 0,5 PONTOS) :)


-- CRIANDO TABELA _STG

```sql
CREATE TABLE CLIENTES_STG (
  NOME VARCHAR2(100) NOT NULL,
  EMAIL VARCHAR2(120) NOT NULL
);
```


-- INSERINDO E ALTERANDO DADOS

```sql
INSERT INTO CLIENTES_STG (nome, email)
VALUES ('Pedro Atualizado', 'pedro@carros.com'); -- Atualizar

INSERT INTO CLIENTES_STG (nome, email)
VALUES ('Carlos Novo', 'carlos@carros.com'); -- Inserir
```



-- MERGE (0,5 pontos)

```sql
MERGE INTO CLIENTES c
USING CLIENTES_STG s
   ON (c.EMAIL = s.EMAIL)
WHEN MATCHED THEN
   UPDATE SET c.NOME = s.NOME
WHEN NOT MATCHED THEN
   INSERT (NOME, TELEFONE, EMAIL)
   VALUES (s.NOME, NULL, s.EMAIL); 
```